import { __read, __spread } from 'tslib';
import { defer, merge, of } from 'rxjs';
import { distinctUntilChanged, map } from 'rxjs/operators';
import { coerceArray, isNil } from './utils';
function getControlValue(control) {
  if (control.getRawValue) {
    return control.getRawValue();
  }
  return control.value;
}
function compareErrors(a, b) {
  if (isNil(a) || isNil(b)) {
    return a === b;
  }
  return JSON.stringify(a) === JSON.stringify(b);
}
export function controlValueChanges$(control) {
  return merge(
    defer(function() {
      return of(getControlValue(control));
    }),
    control.valueChanges.pipe(
      map(function() {
        return getControlValue(control);
      })
    )
  );
}
export function controlDisabled$(control) {
  return merge(
    defer(function() {
      return of(control.disabled);
    }),
    control.statusChanges.pipe(
      map(function() {
        return control.disabled;
      }),
      distinctUntilChanged()
    )
  );
}
export function controlEnabled$(control) {
  return merge(
    defer(function() {
      return of(control.enabled);
    }),
    control.statusChanges.pipe(
      map(function() {
        return control.enabled;
      }),
      distinctUntilChanged()
    )
  );
}
export function controlStatusChanges$(control) {
  return merge(
    defer(function() {
      return of(control.status);
    }),
    control.statusChanges.pipe(
      map(function() {
        return control.status;
      }),
      distinctUntilChanged()
    )
  );
}
export function controlErrorChanges$(control) {
  return merge(
    defer(function() {
      return of(control.errors);
    }),
    control.valueChanges.pipe(
      map(function() {
        return control.errors;
      }),
      distinctUntilChanged(function(a, b) {
        return compareErrors(a, b);
      })
    )
  );
}
export function enableControl(control, enabled, opts) {
  if (enabled) {
    control.enable(opts);
  } else {
    control.disable(opts);
  }
}
export function disableControl(control, disabled, opts) {
  enableControl(control, !disabled, opts);
}
export function controlDisabledWhile(control, observable, opts) {
  return observable.subscribe(function(isDisabled) {
    return disableControl(control, isDisabled, opts);
  });
}
export function controlEnabledWhile(control, observable, opts) {
  return observable.subscribe(function(isEnabled) {
    return enableControl(control, isEnabled, opts);
  });
}
export function mergeControlValidators(control, validators) {
  control.setValidators(__spread([control.validator], coerceArray(validators)));
  control.updateValueAndValidity();
}
export function validateControlOn(control, validation) {
  return validation.subscribe(function(maybeError) {
    control.setErrors(maybeError);
  });
}
export function hasErrorAndTouched(control, error, path) {
  var hasError = control.hasError(error, !path || path.length === 0 ? undefined : path);
  return hasError && control.touched;
}
export function hasErrorAndDirty(control, error, path) {
  var hasError = control.hasError(error, !path || path.length === 0 ? undefined : path);
  return hasError && control.dirty;
}
export function markAllDirty(control) {
  control.markAsDirty({ onlySelf: true });
  control._forEachChild(function(control) {
    return control.markAllAsDirty();
  });
}
export function selectControlValue$(control, mapFn) {
  return control.value$.pipe(map(mapFn), distinctUntilChanged());
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbC1hY3Rpb25zLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQG5nbmVhdC9yZWFjdGl2ZS1mb3Jtcy8iLCJzb3VyY2VzIjpbImxpYi9jb250cm9sLWFjdGlvbnMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUNBLE9BQU8sRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFjLEVBQUUsRUFBZ0IsTUFBTSxNQUFNLENBQUM7QUFDbEUsT0FBTyxFQUFFLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBSzNELE9BQU8sRUFBRSxXQUFXLEVBQUUsS0FBSyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBRTdDLFNBQVMsZUFBZSxDQUFJLE9BQTJCO0lBQ3JELElBQUssT0FBZSxDQUFDLFdBQVcsRUFBRTtRQUNoQyxPQUFRLE9BQWUsQ0FBQyxXQUFXLEVBQUUsQ0FBQztLQUN2QztJQUNELE9BQU8sT0FBTyxDQUFDLEtBQUssQ0FBQztBQUN2QixDQUFDO0FBRUQsU0FBUyxhQUFhLENBQUMsQ0FBMEIsRUFBRSxDQUEwQjtJQUMzRSxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQUU7UUFDeEIsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0tBQ2hCO0lBQ0QsT0FBTyxJQUFJLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxLQUFLLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUM7QUFDakQsQ0FBQztBQUVELE1BQU0sVUFBVSxvQkFBb0IsQ0FBSSxPQUEyQjtJQUNqRSxPQUFPLEtBQUssQ0FDVixLQUFLLENBQUMsY0FBTSxPQUFBLEVBQUUsQ0FBQyxlQUFlLENBQUMsT0FBTyxDQUFDLENBQUMsRUFBNUIsQ0FBNEIsQ0FBQyxFQUN6QyxPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsY0FBTSxPQUFBLGVBQWUsQ0FBQyxPQUFPLENBQUMsRUFBeEIsQ0FBd0IsQ0FBQyxD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LENBQUMsYUFBYSxDQUFDLFVBQUEsT0FBTyxJQUFJLE9BQUEsT0FBTyxDQUFDLGNBQWMsRUFBRSxFQUF4QixDQUF3QixDQUFDLENBQUM7QUFDdEUsQ0FBQztBQUVELE1BQU0sVUFBVSxtQkFBbUIsQ0FDakMsT0FBcUQsRUFDckQsS0FBNEI7SUFFNUIsT0FBUSxPQUFPLENBQUMsTUFBMEIsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLG9CQUFvQixFQUFFLENBQUMsQ0FBQztBQUN0RixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVmFsaWRhdGlvbkVycm9ycyB9IGZyb20gJ0Bhbmd1bGFyL2Zvcm1zJztcbmltcG9ydCB7IGRlZmVyLCBtZXJnZSwgT2JzZXJ2YWJsZSwgb2YsIFN1YnNjcmlwdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCB9IGZyb20gJ3J4anMvb3BlcmF0b3JzJztcbmltcG9ydCB7IEZvcm1BcnJheSB9IGZyb20gJy4vZm9ybUFycmF5JztcbmltcG9ydCB7IEZvcm1Db250cm9sIH0gZnJvbSAnLi9mb3JtQ29udHJvbCc7XG5pbXBvcnQgeyBGb3JtR3JvdXAgfSBmcm9tICcuL2Zvcm1Hcm91cCc7XG5pbXBvcnQgeyBBYnN0cmFjdENvbnRyb2wsIENvbnRyb2xPcHRpb25zLCBDb250cm9sU3RhdGUsIFZhbGlkYXRvckZuLCBDb250cm9sUGF0aCB9IGZyb20gJy4vdHlwZXMnO1xuaW1wb3J0IHsgY29lcmNlQXJyYXksIGlzTmlsIH0gZnJvbSAnLi91dGlscyc7XG5cbmZ1bmN0aW9uIGdldENvbnRyb2xWYWx1ZTxUPihjb250cm9sOiBBYnN0cmFjdENvbnRyb2w8VD4pOiBUIHtcbiAgaWYgKChjb250cm9sIGFzIGFueSkuZ2V0UmF3VmFsdWUpIHtcbiAgICByZXR1cm4gKGNvbnRyb2wgYXMgYW55KS5nZXRSYXdWYWx1ZSgpO1xuICB9XG4gIHJldHVybiBjb250cm9sLnZhbHVlO1xufVxuXG5mdW5jdGlvbiBjb21wYXJlRXJyb3JzKGE6IFZhbGlkYXRpb25FcnJvcnMgfCBudWxsLCBiOiBWYWxpZGF0aW9uRXJyb3JzIHwgbnVsbCkge1xuICBpZiAoaXNOaWwoYSkgfHwgaXNOaWwoYikpIHtcbiAgICByZXR1cm4gYSA9PT0gYjtcbiAgfVxuICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYSkgPT09IEpTT04uc3RyaW5naWZ5KGIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udHJvbFZhbHVlQ2hhbmdlcyQ8VD4oY29udHJvbDogQWJzdHJhY3RDb250cm9sPFQ+KTogT2JzZXJ2YWJsZTxUPiB7XG4gIHJldHVybiBtZXJnZShcbiAgICBkZWZlcigoKSA9PiBvZihnZXRDb250cm9sVmFsdWUoY29udHJvbCkpKSxcbiAgICBjb250cm9sLnZhbHVlQ2hhbmdlcy5waXBlKG1hcCgoKSA9PiBnZXRDb250cm9sVmFsdWUoY29udHJvbCkpKVxuICApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udHJvbERpc2FibGVkJDxUPihjb250cm9sOiBBYnN0cmFjdENvbnRyb2w8VD4pOiBPYnNlcnZhYmxlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIG1lcmdlKFxuICAgIGRlZmVyKCgpID0+IG9mKGNvbnRyb2wuZGlzYWJsZWQpKSxcbiAgICBjb250cm9sLnN0YXR1c0NoYW5nZXMucGlwZShcbiAgICAgIG1hcCgoKSA9PiBjb250cm9sLmRpc2FibGVkKSxcbiAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKClcbiAgICApXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250cm9sRW5hYmxlZCQ8VD4oY29udHJvbDogQWJzdHJhY3RDb250cm9sPFQ+KTogT2JzZXJ2YWJsZTxib29sZWFuPiB7XG4gIHJldHVybiBtZXJnZShcbiAgICBkZWZlcigoKSA9PiBvZihjb250cm9sLmVuYWJsZWQpKSxcbiAgICBjb250cm9sLnN0YXR1c0NoYW5nZXMucGlwZShcbiAgICAgIG1hcCgoKSA9PiBjb250cm9sLmVuYWJsZWQpLFxuICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKVxuICAgIClcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRyb2xTdGF0dXNDaGFuZ2VzJDxUPihjb250cm9sOiBBYnN0cmFjdENvbnRyb2w8VD4pOiBPYnNlcnZhYmxlPENvbnRyb2xTdGF0ZT4ge1xuICByZXR1cm4gbWVyZ2UoXG4gICAgZGVmZXIoKCkgPT4gb2YoY29udHJvbC5zdGF0dXMgYXMgQ29udHJvbFN0YXRlKSksXG4gICAgY29udHJvbC5zdGF0dXNDaGFuZ2VzLnBpcGUoXG4gICAgICBtYXAoKCkgPT4gY29udHJvbC5zdGF0dXMgYXMgQ29udHJvbFN0YXRlKSxcbiAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKClcbiAgICApXG4gICk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250cm9sRXJyb3JDaGFuZ2VzJDxFPihjb250cm9sOiBBYnN0cmFjdENvbnRyb2wpOiBPYnNlcnZhYmxlPEUgfCBudWxsPiB7XG4gIHJldHVybiBtZXJnZShcbiAgICBkZWZlcigoKSA9PiBvZihjb250cm9sLmVycm9ycyBhcyBFKSksXG4gICAgY29udHJvbC52YWx1ZUNoYW5nZXMucGlwZShcbiAgICAgIG1hcCgoKSA9PiBjb250cm9sLmVycm9ycyBhcyBFKSxcbiAgICAgIGRpc3RpbmN0VW50aWxDaGFuZ2VkKChhLCBiKSA9PiBjb21wYXJlRXJyb3JzKGEsIGIpKVxuICAgIClcbiAgKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGVuYWJsZUNvbnRyb2w8VD4oY29udHJvbDogQWJzdHJhY3RDb250cm9sPFQ+LCBlbmFibGVkOiBib29sZWFuLCBvcHRzPzogQ29udHJvbE9wdGlvbnMpOiB2b2lkIHtcbiAgaWYgKGVuYWJsZWQpIHtcbiAgICBjb250cm9sLmVuYWJsZShvcHRzKTtcbiAgfSBlbHNlIHtcbiAgICBjb250cm9sLmRpc2FibGUob3B0cyk7XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc2FibGVDb250cm9sPFQ+KGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDxUPiwgZGlzYWJsZWQ6IGJvb2xlYW4sIG9wdHM/OiBDb250cm9sT3B0aW9ucyk6IHZvaWQge1xuICBlbmFibGVDb250cm9sKGNvbnRyb2wsICFkaXNhYmxlZCwgb3B0cyk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjb250cm9sRGlzYWJsZWRXaGlsZTxUPihcbiAgY29udHJvbDogQWJzdHJhY3RDb250cm9sPFQ+LFxuICBvYnNlcnZhYmxlOiBPYnNlcnZhYmxlPGJvb2xlYW4+LFxuICBvcHRzPzogQ29udHJvbE9wdGlvbnNcbik6IFN1YnNjcmlwdGlvbiB7XG4gIHJldHVybiBvYnNlcnZhYmxlLnN1YnNjcmliZShpc0Rpc2FibGVkID0+IGRpc2FibGVDb250cm9sKGNvbnRyb2wsIGlzRGlzYWJsZWQsIG9wdHMpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRyb2xFbmFibGVkV2hpbGU8VD4oXG4gIGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDxUPixcbiAgb2JzZXJ2YWJsZTogT2JzZXJ2YWJsZTxib29sZWFuPixcbiAgb3B0cz86IENvbnRyb2xPcHRpb25zXG4pOiBTdWJzY3JpcHRpb24ge1xuICByZXR1cm4gb2JzZXJ2YWJsZS5zdWJzY3JpYmUoaXNFbmFibGVkID0+IGVuYWJsZUNvbnRyb2woY29udHJvbCwgaXNFbmFibGVkLCBvcHRzKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZXJnZUNvbnRyb2xWYWxpZGF0b3JzPFQsIENvbnRyb2wgZXh0ZW5kcyBBYnN0cmFjdENvbnRyb2w8VD4+KFxuICBjb250cm9sOiBDb250cm9sLFxuICB2YWxpZGF0b3JzOiBWYWxpZGF0b3JGbjxUPiB8IFZhbGlkYXRvckZuPFQ+W11cbik6IHZvaWQge1xuICBjb250cm9sLnNldFZhbGlkYXRvcnMoW2NvbnRyb2wudmFsaWRhdG9yLCAuLi5jb2VyY2VBcnJheSh2YWxpZGF0b3JzKV0pO1xuICBjb250cm9sLnVwZGF0ZVZhbHVlQW5kVmFsaWRpdHkoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlQ29udHJvbE9uPFQ+KGNvbnRyb2w6IEFic3RyYWN0Q29udHJvbDxUPiwgdmFsaWRhdGlvbjogT2JzZXJ2YWJsZTxudWxsIHwgb2JqZWN0Pik6IFN1YnNjcmlwdGlvbiB7XG4gIHJldHVybiB2YWxpZGF0aW9uLnN1YnNjcmliZShtYXliZUVycm9yID0+IHtcbiAgICBjb250cm9sLnNldEVycm9ycyhtYXliZUVycm9yKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBoYXNFcnJvckFuZFRvdWNoZWQ8VD4oY29udHJvbDogQWJzdHJhY3RDb250cm9sPFQ+LCBlcnJvcjogc3RyaW5nLCBwYXRoPzogQ29udHJvbFBhdGgpOiBib29sZWFuIHtcbiAgY29uc3QgaGFzRXJyb3IgPSBjb250cm9sLmhhc0Vycm9yKGVycm9yLCAhcGF0aCB8fCBwYXRoLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IHBhdGgpO1xuICByZXR1cm4gaGFzRXJyb3IgJiYgY29udHJvbC50b3VjaGVkO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaGFzRXJyb3JBbmREaXJ0eTxUPihjb250cm9sOiBBYnN0cmFjdENvbnRyb2w8VD4sIGVycm9yOiBzdHJpbmcsIHBhdGg/OiBDb250cm9sUGF0aCk6IGJvb2xlYW4ge1xuICBjb25zdCBoYXNFcnJvciA9IGNvbnRyb2wuaGFzRXJyb3IoZXJyb3IsICFwYXRoIHx8IHBhdGgubGVuZ3RoID09PSAwID8gdW5kZWZpbmVkIDogcGF0aCk7XG4gIHJldHVybiBoYXNFcnJvciAmJiBjb250cm9sLmRpcnR5O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWFya0FsbERpcnR5PFQ+KGNvbnRyb2w6IEZvcm1BcnJheTxUPiB8IEZvcm1Hcm91cDxUPik6IHZvaWQge1xuICBjb250cm9sLm1hcmtBc0RpcnR5KHsgb25seVNlbGY6IHRydWUgfSk7XG4gIChjb250cm9sIGFzIGFueSkuX2ZvckVhY2hDaGlsZChjb250cm9sID0+IGNvbnRyb2wubWFya0FsbEFzRGlydHkoKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWxlY3RDb250cm9sVmFsdWUkPFQsIFI+KFxuICBjb250cm9sOiBGb3JtR3JvdXA8VD4gfCBGb3JtQXJyYXk8VD4gfCBGb3JtQ29udHJvbDxUPixcbiAgbWFwRm46IChzdGF0ZTogVCB8IFRbXSkgPT4gUlxuKTogT2JzZXJ2YWJsZTxSPiB7XG4gIHJldHVybiAoY29udHJvbC52YWx1ZSQgYXMgT2JzZXJ2YWJsZTxhbnk+KS5waXBlKG1hcChtYXBGbiksIGRpc3RpbmN0VW50aWxDaGFuZ2VkKCkpO1xufVxuIl19
